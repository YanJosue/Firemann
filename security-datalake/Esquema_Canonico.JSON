{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Fireman Canonical Event Schema",
    "description": "El formato único y estandarizado para todos los eventos de seguridad procesados en el pipeline Fireman.",
    "type": "object",
    "required": [
      "event_id",
      "ingestion_timestamp",
      "source_system",
      "event",
      "raw_log"
    ],
    "properties": {
      "event_id": {
        "description": "Identificador Único Universal (UUID) para el evento.",
        "type": "string",
        "format": "uuid"
      },
      "ingestion_timestamp": {
        "description": "Fecha y hora en formato ISO 8601 UTC cuando el evento fue recibido.",
        "type": "string",
        "format": "date-time"
      },
      "source_system": {
        "description": "El sistema que originó el log (ej. SonicWall-TZ2070, MS-Defender).",
        "type": "string"
      },
      "event": {
        "description": "Detalles sobre la acción que ocurrió.",
        "type": "object",
        "properties": {
          "type": { "type": "string", "enum": ["network_flow", "login", "file_access", "process_creation", "email_event", "auth_event"] },
          "action": { "type": "string", "enum": ["allow", "deny", "quarantine", "delete", "login_success", "login_failure", "file_created", "file_read", "file_modified"] },
          "severity": { "type": "string", "enum": ["info", "low", "medium", "high", "critical"] }
        },
        "required": ["type"]
      },
      "source": {
        "description": "Describe el actor que inició el evento.",
        "type": "object",
        "properties": {
          "ip": { "type": "string", "format": "ipv4" },
          "port": { "type": "integer", "minimum": 0, "maximum": 65535 },
          "hostname": { "type": "string" },
          "user": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "email": { "type": "string", "format": "email" }
            }
          },
          "process": {
            "type": "object",
            "properties": {
              "pid": { "type": "integer" },
              "name": { "type": "string" },
              "path": { "type": "string" }
            }
          }
        }
      },
      "target": {
        "description": "Describe el objetivo del evento.",
        "type": "object",
        "properties": {
          "ip": { "type": "string", "format": "ipv4" },
          "port": { "type": "integer", "minimum": 0, "maximum": 65535 },
          "hostname": { "type": "string" },
          "file": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "path": { "type": "string" },
              "hash_md5": { "type": "string" },
              "hash_sha256": { "type": "string" }
            }
          }
        }
      },
      "network": {
        "description": "Detalles específicos de eventos de red.",
        "type": "object",
        "properties": {
          "protocol": { "type": "string" },
          "bytes_in": { "type": "integer" },
          "bytes_out": { "type": "integer" },
          "direction": { "type": "string", "enum": ["inbound", "outbound", "internal"] }
        }
      },
      "email": {
        "description": "Detalles específicos de eventos de correo electrónico.",
        "type": "object",
        "properties": {
          "sender_address": { "type": "string", "format": "email" },
          "recipient_address": { "type": "string", "format": "email" },
          "subject": { "type": "string" },
          "attachment_count": { "type": "integer" }
        }
      },
      "enrichment": {
        "description": "Contenedor para toda la información añadida por los servicios de enriquecimiento.",
        "type": "object",
        "properties": {}
      },
      "raw_log": {
        "description": "El log original completo, sin procesar, para auditoría.",
        "type": "string"
      }
    }
  }
  